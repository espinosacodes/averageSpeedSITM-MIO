graph TB
    A["Sistema de Cálculo de Velocidad Promedio SITM-MIO"] --> B1["1.1 Procesamiento de Datagramas Históricos"]
    A --> B2["1.2 Procesamiento de Datagramas en Tiempo Real"]
    A --> B3["1.3 Gestión de Grafos y Arcos"]
    A --> B4["1.4 Almacenamiento y Persistencia"]
    A --> B5["1.5 Coordinación y Orquestación"]
    
    B1 --> C11["1.1.1 Carga y Validación de Archivo"]
    B1 --> C12["1.1.2 Particionamiento de Datos"]
    B1 --> C13["1.1.3 Asignación de Particiones a Workers"]
    B1 --> C14["1.1.4 Procesamiento Distribuido de Particiones"]
    B1 --> C15["1.1.5 Agregación de Resultados Parciales"]
    B1 --> C16["1.1.6 Persistencia de Resultados Históricos"]
    
    B2 --> C21["1.2.1 Recepción de Stream de Datagramas"]
    B2 --> C22["1.2.2 Procesamiento Incremental de Datagrama"]
    B2 --> C23["1.2.3 Actualización de Estado en Memoria"]
    B2 --> C24["1.2.4 Publicación de Actualizaciones en Tiempo Real"]
    B2 --> C25["1.2.5 Actualización de Cache en Tiempo Real"]
    
    B3 --> C31["1.3.1 Carga de Archivos CSV de Grafo"]
    B3 --> C32["1.3.2 Construcción de Grafo Estructurado"]
    B3 --> C33["1.3.3 Identificación y Indexación de Arcos Únicos"]
    B3 --> C34["1.3.4 Mapeo de Coordenadas GPS a Arcos"]
    B3 --> C35["1.3.5 Consulta y Acceso al Grafo"]
    
    B4 --> C41["1.4.1 Almacenamiento en Base de Datos PostgreSQL"]
    B4 --> C42["1.4.2 Cache de Velocidades Frecuentes"]
    B4 --> C43["1.4.3 Persistencia de Metadatos de Procesamiento"]
    B4 --> C44["1.4.4 Consulta de Velocidades Almacenadas"]
    
    B5 --> C51["1.5.1 Registro y Gestión de Workers"]
    B5 --> C52["1.5.2 Gestión de Tareas de Procesamiento"]
    B5 --> C53["1.5.3 Balanceo de Carga"]
    B5 --> C54["1.5.4 Monitoreo y Estado del Sistema"]
    B5 --> C55["1.5.5 Manejo de Errores y Recuperación"]
    
    style A fill:#2e7d32,stroke:#1b5e20,stroke-width:3px,color:#fff
    style B1 fill:#1976d2,stroke:#0d47a1,stroke-width:2px,color:#fff
    style B2 fill:#1976d2,stroke:#0d47a1,stroke-width:2px,color:#fff
    style B3 fill:#1976d2,stroke:#0d47a1,stroke-width:2px,color:#fff
    style B4 fill:#1976d2,stroke:#0d47a1,stroke-width:2px,color:#fff
    style B5 fill:#1976d2,stroke:#0d47a1,stroke-width:2px,color:#fff
    style C11 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C12 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C13 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C14 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C15 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C16 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C21 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C22 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C23 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C24 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C25 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C31 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C32 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C33 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C34 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C35 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C41 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C42 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C43 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C44 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C51 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C52 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C53 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C54 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
    style C55 fill:#42a5f5,stroke:#0277bd,stroke-width:1px
